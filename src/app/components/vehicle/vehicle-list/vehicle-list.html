<div class="vehicle-container">
  <h2>Fahrzeugliste</h2>

  <div class="filter-panel">
    <input type="text" placeholder="Fahrzeug-ID" [(ngModel)]="filter.id" />
    <input type="text" placeholder="Marke" [(ngModel)]="filter.make" />
    <input type="text" placeholder="Modell" [(ngModel)]="filter.model" />
    <input type="text" placeholder="Farbe" [(ngModel)]="filter.color" />
    <select [(ngModel)]="filter.status">
      <option value="">Alle Status</option>
      <option value="Verf√ºgbar">Verf√ºgbar</option>
      <option value="Reserviert">Reserviert</option>
      <option value="Verkauft">Verkauft</option>
    </select>
    <button class="btn-filter" (click)="applyFilter()">Filter anwenden</button>
    <button class="btn-reset" (click)="resetFilter()">Zur√ºcksetzen</button>
  </div>

  <div class="actions">
    <button class="btn-export-csv" (click)="exportCsv()">CSV exportieren</button>
    <button class="btn-export-json" (click)="exportJson()">JSON exportieren</button>
    <button class="btn-export-xml" (click)="exportXml()">XML exportieren</button>
  </div>

  <table class="vehicle-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>Marke</th>
        <th>Modell</th>
        <th>Erstzulassung</th>
        <th>Farbe</th>
        <th>Status</th>
        <th>Ausstattung</th>
        <th>Aktionen</th>
      </tr>
    </thead>
    <tbody>
      @for (vehicle of vehicles$ | async; track vehicle.id) {
        <tr>
          <td>{{ vehicle.id }}</td>
          <td>{{ vehicle.make }}</td>
          <td>{{ vehicle.model }}</td>
          <td>{{ vehicle.initialRegistration || '-' }}</td>
          <td>{{ vehicle.color || '-' }}</td>
          <td>
            <select class="status-select" 
                    [value]="vehicle.status" 
                    (change)="changeStatus(vehicle, $any($event.target).value)">
              <option value="Verf√ºgbar">Verf√ºgbar</option>
              <option value="Reserviert">Reserviert</option>
              <option value="Verkauft">Verkauft</option>
            </select>
          </td>
          <td class="equipment-cell">
            <div class="equipment-tags">
              @for (featureName of vehicle.ausstattung || []; track featureName) {
                <span class="equipment-tag">{{ featureName }}</span>
              }
              @if (!(vehicle.ausstattung && vehicle.ausstattung.length > 0)) {
                <span class="no-equipment">Keine Ausstattung</span>
              }
            </div>
          </td>
          <td class="actions-cell">
            <button class="btn-edit" (click)="editVehicleClick(vehicle.id)">
              ‚úèÔ∏è Bearbeiten
            </button>
            <button class="btn-delete" (click)="deleteVehicle(vehicle.id)">
              üóëÔ∏è L√∂schen
            </button>
          </td>
        </tr>
      }
    </tbody>
  </table>

  @if ((vehicles$ | async)?.length === 0) {
    <div class="no-data">
      <p>Keine Fahrzeuge gefunden.</p>
    </div>
  }
</div>
